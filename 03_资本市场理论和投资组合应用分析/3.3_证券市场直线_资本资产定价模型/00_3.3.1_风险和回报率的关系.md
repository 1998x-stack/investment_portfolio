# 00_3.3.1_风险和回报率的关系

"""

Lecture: 03_资本市场理论和投资组合应用分析/3.3_证券市场直线/资本资产定价模型
Content: 00_3.3.1_风险和回报率的关系

"""

### 3.3.1 风险和回报率的关系 - 深度解析

#### 概述

在金融市场中，风险和回报率的关系是投资决策的核心概念之一。理解这种关系可以帮助投资者更好地评估投资组合的表现，并在不同的市场条件下做出更明智的投资选择。本文将详细探讨风险和回报率之间的关系，特别是通过资本资产定价模型（CAPM）和证券市场直线（SML）来解释这一关系。

#### 风险和回报率的定义

1. **风险**：
   - **定义**：风险是指投资回报的不确定性，通常用波动性（标准差）来衡量。风险越大，投资回报的波动性越大。
   - **分类**：风险可以分为系统风险（市场风险）和非系统风险（特定风险）。系统风险是所有资产共有的风险，不能通过分散投资来消除；非系统风险是特定于某一资产或行业的风险，可以通过分散投资来减小。

2. **回报率**：
   - **定义**：回报率是指投资所获得的收益率，包括资本利得和收益的总和。回报率越高，投资收益越大。
   - **预期回报率**：预期回报率是投资者对未来某一时期内所能获得的回报率的期望值，通常通过历史数据和市场分析来估计。

#### 风险和回报率的关系

根据金融理论，高风险通常伴随着高回报。具体来说，投资者在承担较高风险时，期望获得更高的回报以补偿其所承担的风险。这一关系在CAPM和SML中得到了明确的表达。

##### 资本资产定价模型（CAPM）

CAPM公式如下：

$$ E(R_i) = R_f + \beta_i (E(R_m) - R_f) $$

其中：
- $ E(R_i) $ 是资产 $ i $ 的预期回报率
- $ R_f $ 是无风险利率
- $ \beta_i $ 是资产 $ i $ 的贝塔系数，表示资产相对于市场组合的系统风险
- $ E(R_m) $ 是市场组合的预期回报率
- $ E(R_m) - R_f $ 是市场风险溢价，表示市场组合的回报率超过无风险利率的部分

CAPM说明，资产的预期回报率取决于无风险利率和市场风险溢价。贝塔系数反映了资产的系统风险，贝塔系数越高，资产的预期回报率越高。

##### 证券市场直线（SML）

SML是CAPM的图形表示，展示了预期回报率与贝塔系数之间的线性关系。SML的方程与CAPM公式相同：

$$ E(R_i) = R_f + \beta_i (E(R_m) - R_f) $$

在SML图上，纵轴表示预期回报率，横轴表示贝塔系数。SML从无风险利率 $ R_f $ 开始，斜率为市场风险溢价 $ E(R_m) - R_f $。

#### 实践应用

1. **资产定价**：
   - **高估或低估**：如果某资产的实际回报率高于SML上的回报率，说明该资产被低估；如果低于SML上的回报率，说明该资产被高估。
   - **投资决策**：投资者可以根据SML来评估资产的定价是否合理，并做出相应的投资决策。

2. **投资组合管理**：
   - **风险调整**：投资者可以根据自身的风险偏好，选择在SML上的适当点来构建投资组合。通过调整投资组合中的资产权重，可以在不同的风险水平下实现最佳回报。

3. **业绩评估**：
   - **比较基准**：通过比较投资组合的回报率与SML，可以评估投资管理的绩效。如果投资组合的回报率低于SML，说明该组合未能有效地利用市场信息和无风险资产的组合。

#### 图示解释

图3-2展示了风险和回报率的关系：

```
预期回报率 (E(R))
|
|                            *
|                          /
|                        /
|                      /
|                    /    SML
|                  /
|                /
|              /
|            /
|          /
|        /
|      /
|    /
|  /
|/___________________________________________ 风险 (β)
          R_f                      β_m
```

在图中：
- 纵轴表示预期回报率 $ E(R) $。
- 横轴表示贝塔系数 $ \beta $。
- 直线从无风险利率 $ R_f $ 点开始，与市场组合 $ M $ 的预期回报率和贝塔系数点相切，形成SML。

#### 案例分析

假设以下条件：
- 无风险利率 $ R_f $ 为2%
- 市场组合的预期回报率 $ E(R_m) $ 为10%
- 某股票 $ A $ 的贝塔系数 $ \beta_A $ 为1.2
- 某股票 $ B $ 的贝塔系数 $ \beta_B $ 为0.8

根据CAPM公式，可以计算出股票A和B的预期回报率：

#### 股票A：
$$ E(R_A) = R_f + \beta_A (E(R_m) - R_f) $$
$$ E(R_A) = 2\% + 1.2 \times (10\% - 2\%) $$
$$ E(R_A) = 2\% + 1.2 \times 8\% $$
$$ E(R_A) = 2\% + 9.6\% $$
$$ E(R_A) = 11.6\% $$

#### 股票B：
$$ E(R_B) = R_f + \beta_B (E(R_m) - R_f) $$
$$ E(R_B) = 2\% + 0.8 \times (10\% - 2\%) $$
$$ E(R_B) = 2\% + 0.8 \times 8\% $$
$$ E(R_B) = 2\% + 6.4\% $$
$$ E(R_B) = 8.4\% $$

### 总结

风险和回报率之间的关系是投资决策的核心。通过CAPM和SML，投资者可以量化这种关系，并利用这些工具进行资产定价、投资组合管理和业绩评估。理解风险和回报率的关系，有助于在复杂多变的市场环境中做出更明智的投资决策。

---


### CAPM的推导：假设条件和数学证明

资本资产定价模型（CAPM）旨在解释资产的预期回报率与其系统风险（贝塔系数）之间的关系。以下是CAPM的推导过程，包括假设条件和数学公式。

#### 假设条件

1. **投资者行为假设**：
   - 所有投资者是风险厌恶的，理性的，并且根据均值-方差分析做出投资决策。
   - 所有投资者都有相同的投资期限。
   - 所有投资者都有相同的预期，即对资产的预期回报、方差和协方差的预期相同。

2. **市场假设**：
   - 资本市场是完全竞争的，没有任何投资者可以影响市场价格。
   - 资产是无限可分的。
   - 没有交易成本和税收。
   - 投资者可以在无风险利率下无限制地借入和贷出资金。
   - 所有资产都是可投资的，即不存在无法购买的资产。

#### 数学推导

1. **均值-方差优化**：
   在现代投资组合理论中，投资者通过均值-方差优化选择其最优投资组合。在引入无风险资产后，所有投资者的最优投资组合都位于资本市场线（CML）上，且所有投资者持有相同的市场组合。

2. **市场组合和资本市场线（CML）**：
   市场组合 $ M $ 是所有投资者持有的共同组合。CML的公式如下：
   $$ E(R_p) = R_f + \frac{E(R_m) - R_f}{\sigma_m} \cdot \sigma_p $$
   其中，$ E(R_p) $ 是投资组合的预期回报率，$ R_f $ 是无风险利率，$ E(R_m) $ 是市场组合的预期回报率，$ \sigma_m $ 是市场组合的标准差，$ \sigma_p $ 是投资组合的标准差。

3. **证券市场线（SML）**：
   SML展示了单个资产或投资组合的预期回报率与其系统风险（贝塔系数）之间的关系。SML的方程与CAPM公式相同：
   $$ E(R_i) = R_f + \beta_i (E(R_m) - R_f) $$
   其中，$ \beta_i $ 是资产 $ i $ 的贝塔系数，表示资产相对于市场组合的系统风险。

4. **贝塔系数的定义**：
   贝塔系数 $ \beta_i $ 衡量单个资产相对于市场组合的系统风险，定义为：
   $$ \beta_i = \frac{\text{Cov}(R_i, R_m)}{\text{Var}(R_m)} $$
   其中，$ \text{Cov}(R_i, R_m) $ 是资产 $ i $ 的回报率与市场组合回报率的协方差，$ \text{Var}(R_m) $ 是市场组合回报率的方差。

5. **CAPM的推导**：
   假设市场处于均衡状态，即所有资产的需求等于供应。在这种情况下，所有投资者都持有市场组合 $ M $ 的一部分，并可以借入或贷出无风险资产。根据CML公式，投资者持有的任何组合 $ P $ 的预期回报率可以表示为：
   $$ E(R_p) = R_f + \frac{E(R_m) - R_f}{\sigma_m} \cdot \sigma_p $$
   
   对于单个资产 $ i $，其预期回报率 $ E(R_i) $ 也应满足上述公式。然而，单个资产的风险由其与市场组合的协方差决定，因此可以用贝塔系数表示其风险。将贝塔系数 $ \beta_i $ 代入上述公式，得到CAPM公式：
   $$ E(R_i) = R_f + \beta_i (E(R_m) - R_f) $$
   
   这说明资产的预期回报率取决于无风险利率、市场风险溢价和资产的系统风险（贝塔系数）。

#### 详细推导步骤

1. **定义市场组合和CML**：
   市场组合 $ M $ 的预期回报率和标准差分别为 $ E(R_m) $ 和 $ \sigma_m $。CML表示在不同风险水平下，由市场组合和无风险资产组成的最优组合的预期回报率。

2. **引入无风险资产**：
   投资者可以通过借入或贷出无风险资产来调整其投资组合的风险和回报。假设投资者持有市场组合 $ M $ 并借入或贷出无风险资产，则其投资组合 $ P $ 的预期回报率和标准差可以表示为：
   $$ E(R_p) = R_f + \left( \frac{E(R_m) - R_f}{\sigma_m} \right) \sigma_p $$

3. **定义贝塔系数**：
   单个资产 $ i $ 的贝塔系数 $ \beta_i $ 定义为其回报率与市场组合回报率的协方差与市场组合回报率方差的比值：
   $$ \beta_i = \frac{\text{Cov}(R_i, R_m)}{\text{Var}(R_m)} $$

4. **推导CAPM公式**：
   假设市场处于均衡状态，即所有投资者持有市场组合的一部分，并可以借入或贷出无风险资产。在这种情况下，单个资产的预期回报率 $ E(R_i) $ 应满足CML公式。然而，单个资产的风险由其与市场组合的协方差决定，因此可以用贝塔系数表示其风险。将贝塔系数代入CML公式，得到CAPM公式：
   $$ E(R_i) = R_f + \beta_i (E(R_m) - R_f) $$

### 总结

CAPM通过引入无风险资产和市场组合，解释了资产的预期回报率与其系统风险（贝塔系数）之间的关系。CAPM公式基于多个假设条件，并通过均值-方差优化和资本市场线（CML）推导得到。理解CAPM的假设条件和推导过程，有助于更好地应用这一模型进行资产定价和投资决策。

---

### 资本市场线（CML）公式的推导：均值-方差优化

资本市场线（CML）是投资组合理论中的一个重要概念，表示在不同风险水平下由市场组合和无风险资产组成的最优组合的预期回报率。CML的公式可以通过均值-方差优化推导出来。以下是详细的推导过程。

#### 假设条件

1. **投资者行为假设**：
   - 所有投资者是理性的、风险厌恶的，并且根据均值-方差分析做出投资决策。
   - 所有投资者都有相同的投资期限。
   - 所有投资者对资产的预期回报、方差和协方差有相同的预期。

2. **市场假设**：
   - 资本市场是完全竞争的。
   - 没有交易成本和税收。
   - 投资者可以在无风险利率下无限制地借入和贷出资金。

#### 推导步骤

##### 一、均值-方差优化的基础

在均值-方差优化中，投资者的目标是找到在给定风险水平下具有最高预期回报率的投资组合。有效前沿（Efficient Frontier）上的每个点都代表一个最优投资组合。

1. **有效前沿**：
   有效前沿是表示在不同风险水平下的最优投资组合的曲线。假设有 $ n $ 种资产，每种资产的预期回报率为 $ E(R_i) $，权重为 $ w_i $，协方差矩阵为 $ \Sigma $。

2. **投资组合的预期回报率**：
   $$ E(R_p) = \sum_{i=1}^{n} w_i E(R_i) $$

3. **投资组合的方差**：
   $$ \sigma_p^2 = \sum_{i=1}^{n} \sum_{j=1}^{n} w_i w_j \sigma_{ij} $$

4. **投资组合的标准差**：
   $$ \sigma_p = \sqrt{\sum_{i=1}^{n} \sum_{j=1}^{n} w_i w_j \sigma_{ij}} $$

##### 二、引入无风险资产

在引入无风险资产后，投资者可以通过借入或贷出无风险资产来调整其投资组合的风险和回报。

1. **无风险资产**：
   无风险资产的预期回报率为 $ R_f $，其标准差为0。投资者可以在无风险利率 $ R_f $ 下无限制地借入或贷出资金。

2. **组合构建**：
   设投资者在无风险资产中的投资权重为 $ (1-w) $，在市场组合中的权重为 $ w $。则组合的预期回报率和标准差分别为：
   $$ E(R_c) = (1-w)R_f + wE(R_m) $$
   $$ \sigma_c = w\sigma_m $$

##### 三、推导CML公式

1. **预期回报率和标准差的关系**：
   由于 $ E(R_c) $ 和 $ \sigma_c $ 都是 $ w $ 的线性函数，可以消去 $ w $ 得到 $ E(R_c) $ 和 $ \sigma_c $ 之间的关系。

2. **预期回报率公式**：
   $$ E(R_c) = (1-w)R_f + wE(R_m) $$

3. **标准差公式**：
   $$ \sigma_c = w\sigma_m $$
   其中 $ w = \frac{\sigma_c}{\sigma_m} $

4. **将 $ w $ 带入预期回报率公式**：
   $$ E(R_c) = (1 - \frac{\sigma_c}{\sigma_m})R_f + \frac{\sigma_c}{\sigma_m}E(R_m) $$

5. **整理得到CML公式**：
   $$ E(R_c) = R_f + \frac{E(R_m) - R_f}{\sigma_m} \cdot \sigma_c $$

此公式表示在不同风险水平下，由市场组合和无风险资产组成的最优组合的预期回报率，即资本市场线（CML）。

#### 图示解释

资本市场线（CML）图示如下：

```
预期回报率 (E(R))
|
|                             *
|                          /
|                       /
|                    /
|                 /    CML
|              /
|           /
|        /
|     /
|  /
|/________________________________________ 风险 (σ)
          R_f                      σ_m
```

在图中：
- 纵轴表示预期回报率 $ E(R) $。
- 横轴表示风险（标准差） $ \sigma $。
- 直线从无风险利率 $ R_f $ 开始，与市场组合 $ M $ 的预期回报率和标准差点相切，形成CML。

### 总结

通过均值-方差优化和引入无风险资产，可以推导出资本市场线（CML）公式。CML表示在不同风险水平下，由市场组合和无风险资产组成的最优组合的预期回报率。理解CML的推导过程，有助于更好地应用这一概念进行投资组合管理和风险控制。

