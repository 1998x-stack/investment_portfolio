structure ={
    "01_引论": {
        "1.1_引言": []
    },
    "02_投资组合的构建和分析": {
        "2.1_引言": [],
        "2.2_投资组合的构建过程": [],
        "2.3_马考维茨模型": [],
        "2.4_有效的概念": [],
        "2.5_证券和投资组合的回报率": [
            "2.5.1_风险的度量",
            "2.5.2_投资组合内的风险",
            "2.5.3_多样化",
            "2.5.4_证券的相关性与投资组合的风险",
            "2.5.5_增加证券以消减风险",
            "2.5.6_系统风险和可消除的风险"
        ],
        "2.6_权重的改变与投资组合的风险－回报率的关系": [],
        "2.7_卖空": [],
        "2.8_模型要求的输入": [],
        "2.9_资产配置": [
            "2.9.1_资产类型的风险－回报率特性",
            "2.9.2_生成有效的前沿",
            "2.9.3_回避风险",
            "2.9.4_扩充资产类型",
            "2.9.5_世界市场投资组合"
        ],
        "附录2A_选择有效的投资组合": []
    },
    "03_资本市场理论和投资组合应用分析": {
        "3.1_引言": [],
        "3.2_资本资产定价模型的假设与含义": [
            "3.2.1_借入与贷出",
            "3.2.2_资本市场直线"
        ],
        "3.3_证券市场直线/资本资产定价模型": [
            "3.3.1_风险和回报率的关系",
            "3.3.2_证券的低估与高估",
            "3.3.3_实证检验"
        ],
        "3.4_修正的资本资产定价模型": [
            "3.4.1_税负调整",
            "3.4.2_市场组合的作用"
        ],
        "3.5_单指数模型": [
            "3.5.1_衡量风险与回报率",
            "3.5.2_单指数模型的应用",
            "3.5.3_分析投资组合的风险和回报率",
            "3.5.4_投资组合实用分析"
        ],
        "3.6_基本属性": [
            "3.6.1_β的测量",
            "3.6.2_基础的β",
            "3.6.3_预测β"
        ],
    },
    "04_套利定价理论和多指数模型": {
        "4.1_引言": [],
        "4.2_套利定价理论": [
            "4.2.1_套利定价理论模型",
            "4.2.2_套利过程",
            "4.2.3_超市场因素",
            "4.2.4_定价关系",
            "4.2.5_证券估值",
            "4.2.6_套利过程",
            "4.2.7_均衡模型的比较"
        ],
        "4.3_多指数投资组合分析": [
            "4.3.1_多指数模型",
            "4.3.2_风险和回报率的度量",
            "4.3.3_多指数模型的应用",
            "4.3.4_合成的属性模型"
        ],
        "4.4_应用投资组合分析": [],
        "4.5_投资组合的风险和回报率分析": [
            "4.5.1_有效前沿的生成",
            "4.5.2_投资组合选择模型的检验"
        ],
        "附录4A_将资本资产定价模型和套利定价理论联系起来": [],
        "附录4B_相关的指数转化为不相关的指数": []
    },
    "05_证券估值和风险分析": {
        "5.1_引言": [],
        "5.2_估值理论": [
            "5.2.1_永续年金的估值",
            "5.2.2_债券估值",
            "5.2.3_债券定价定理"
        ],
        "5.3_久期": [],
        "5.4_凸性": [
            "5.4.1_凸性调整",
            "5.4.2_凸性的决定因素",
            "5.4.3_凸性分析的应用"
        ],
        "5.5_再投资率风险": [
            "5.5.1_再投资风险控制",
            "5.5.2_免疫"
        ],
        "5.6_风险增溢": [],
        "5.7_风险的基本来源": [
            "5.7.1_利率风险",
            "5.7.2_购买力风险",
            "5.7.3_经营风险",
            "5.7.4_财务风险",
            "5.7.5_承受风险成分"
        ],
        "附录5A_永续年金的通用公式": []
    },
    "06_估值模型的应用方法": {
        "6.1_引言": [],
        "6.2_股票估值模型": [],
        "6.3_股票价值及不同的模型输入变量": [
            "6.3.1_市盈率和折现率",
            "6.3.2_红利资本化模型：简化形式",
            "6.3.3_估计折现率",
            "6.3.4_周期性公司",
            "6.3.5_技巧的应用"
        ],
        "6.4_增长类股票和两阶段增长模型": [],
        "6.5_证券市场直线方法": [
            "6.5.1_市场直线的运用",
            "6.5.2_单个证券估值"
        ],
        "6.6_超市场因素": [],
        "附录6A_简化红利资本化模型": []
    },
    "07_权益估值模型：简化模型及其应用": {
        "7.1_引言": [],
        "7.2_估值模型的使用": [],
        "7.3_证券估值体系的发展": [
            "7.3.1_格拉汉姆和多德方法",
            "7.3.2_红利折现模型",
            "7.3.3_信息系数/多指标估值模型"
        ],
        "7.4_三阶段红利折现模型的应用": [],
        "7.5_三阶段红利折现模型的简化模型": [],
        "7.6_收益、增长和再估值": [],
        "7.7_市场价格/账面价值和权益回报率模型": [],
        "7.8_q_比率": [],
        "7.9_非公开市场价值": [],
        "7.10_折衷估值": [],
        "7.11_估值与风险变化": [],
        "7.12_风险与折现率": [
            "7.12.1_利率风险",
            "7.12.2_购买力风险",
            "7.12.3_商业与财务风险"
        ],
        "附录7A_三阶段红利资本化模型": []
    },
    "08_修炼型股票选择战略": {
        "8.1_引言": [],
        "8.2_积极－消极战略": [],
        "8.3_股票选择战略": [],
        "8.4_投资过程设计": [],
        "8.5_预测能力衡量": [],
        "8.6_综合预测": [],
        "8.7_回报率预测": [],
        "8.8_回报率分布的产生": [],
        "8.9_按预测能力调整回报率分布": [],
        "8.10_交易成本": [],
        "8.11_运用综合预测": [],
        "8.12_投资组合构建": [],
        "8.13_投资组合最优化": [],
        "8.14_过程适时管理": [],
        "8.15_战略的业绩": [],
        "8.16_买空/卖空战略": [],
        "8.17_回报率模式": [],
        "8.18_买空/卖空风险": [],
        "附录8A_回归方程预测法的含义": [],
        "附录8B_结合预测": [],
        "参考文献": []
    },
    "09_资产类别混合管理": {
        "9.1_引言": [],
        "9.2_战略性资产配置": [],
        "9.3_根据过去预测未来": [],
        "9.4_情景预测法": [
            "9.4.1_情景确定",
            "9.4.2_情景法在资本市场上的运用"
        ],
        "9.5_确定最优资产混合": [],
        "9.6_战术性资产配置": [],
        "9.7_市场敏感性管理": [],
        "9.8_市场的周期性行为": [],
        "9.9_预测市场": [
            "9.9.1_估价指标",
            "9.9.2_市场内在回报率",
            "9.9.3_经济和技术指标"
        ],
        "9.10_股票市场综合预测": [],
        "9.11_资产混合管理": [
            "9.11.1_购买并持有战略",
            "9.11.2_恒定混合战略",
            "9.11.3_投资组合保险",
            "9.11.4_战略特征"
        ],
        "附录9A_资产/负债最优化": [],
        "参考文献": []
    },
    "10_权益投资风格": {
        "10.1_引言": [],
        "10.2_按公司规模分类": [],
        "10.3_结合战略": [],
        "10.4_增长类股票和收益类股票": [],
        "10.5_增长类/收益类股票业绩指数": [],
        "10.6_按价格行为分类": [],
        "10.7_构建投资组合/消极战略": [],
        "10.8_类别轮换战略/积极战略": [],
        "10.9_预测增长类股票的业绩": [
            "10.9.1_利率影响",
            "10.9.2_收益曲线",
            "10.9.3_相对P/E比率"
        ],
        "10.10_非增长类股票的基本特点": [
            "10.10.1_非增长类股票的相对业绩",
            "10.10.2_对预测结果进行调整"
        ],
        "10.11_最优权重": [],
        "附录10A_判别分析法与它的基本变量": [],
        "附录10B_一个确定各类股票最优权重的简单技巧": [],
        "参考文献": []
    },
    "11_国际投资": {
        "11.1_引言": [
            "11.1.1_国际权益市场的规模",
            "11.1.2_全球权益市场的风险－回报率特点"
        ],
        "11.2_国际多样化投资的优点": [
            "11.2.1_市场的波动性和互相关性",
            "11.2.2_国际投资活动要求的最低回报率"
        ],
        "11.3_外汇风险": [
            "11.3.1_风险来源",
            "11.3.2_风险管理",
            "11.3.3_外汇风险对回报率的影响"
        ],
        "11.4_国际投资组合构建": [],
        "11.5_管理国际投资组合": [],
        "附录11A_国际权益投资的估值模型": [],
        "参考文献": []
    },
    "12_金融衍生工具概述": {
        "12.1_引言": [],
        "12.2_期货合约": [],
        "12.3_期权合约": [],
        "12.4_互换合约": [],
        "12.5_衍生工具市场": [],
    },
    "13_期货和期权估值": {
        "13.1_引言": [],
        "13.2_期货定价": [
            "13.2.1_持有成本模型",
            "13.2.2_风险溢价模型"
        ],
        "13.3_期权定价": [
            "13.3.1_二叉树模型",
            "13.3.2_Black-Scholes模型"
        ],
        "13.4_衍生工具的应用": [],
    },
    "14_投资组合业绩评价": {
        "14.1_引言": [],
        "14.2_业绩评价方法": [
            "14.2.1_夏普比率",
            "14.2.2_特雷诺比率",
            "14.2.3_詹森指数"
        ],
        "14.3_投资组合业绩归因分析": [
            "14.3.1_基本方法",
            "14.3.2_多因素归因分析"
        ],
        "14.4_业绩评估实例": [],
    },
    "15_共同基金业绩评价": {
        "15.1_引言": [],
        "15.2_共同基金概述": [],
        "15.3_基金业绩评价方法": [],
        "15.4_基金排名和选择": [],
    },
    "16_对冲基金业绩评价": {
        "16.1_引言": [],
        "16.2_对冲基金概述": [],
        "16.3_基金业绩评价方法": [],
        "16.4_基金排名和选择": [],
    }
}



import os
from typing import Dict, Any

def create_directories_and_files(
        base_path: str, 
        structure: Dict[str, Any], 
        readme_file, 
        parent_path: str = "", 
        level: int = 1
    ):
    heading = "#" * level

    for key, value in structure.items():
        current_path = os.path.join(base_path, key.replace(" ", "_").replace("/", "_").replace("-", "_"))

        # 创建目录
        os.makedirs(current_path, exist_ok=True)

        # 在README中添加章节标题
        if parent_path:
            readme_file.write(f"{heading} {parent_path}/{key}\n\n")
        else:
            readme_file.write(f"{heading} {key}\n\n")

        # 递归调用创建子目录和文件
        if isinstance(value, dict) and value:
            create_directories_and_files(
                current_path, 
                value, 
                readme_file, 
                parent_path + "/" + key if parent_path else key, 
                level + 1
            )
        elif isinstance(value, list) and value:
            for idx, item in enumerate(value):
                if isinstance(item, dict) and item:
                    create_directories_and_files(
                        current_path, 
                        item, 
                        readme_file, 
                        parent_path + "/" + key if parent_path else key, 
                        level + 1
                    )
                else:
                    item = f"{idx:02d}_{item}"
                    # file_name = item.replace(" ", "_").replace("/", "_").replace("-", "_") + ".py"
                    # file_path = os.path.join(current_path, file_name)
                    # with open(file_path, 'w', encoding='utf-8') as file:
                    #     file.write(f"# {item}\n\n")
                    #     file.write(f'"""\n\nLecture: {parent_path}/{key}\nContent: {item}\n\n"""\n\n')

                    # # 在README中添加文件链接
                    # item_clean = item.replace(" ", "_").replace("/", "_").replace("-", "_")
                    # parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
                    # key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
                    # readme_file.write(f"- [{item}](./{parent_clean}/{key_clean}/{item_clean}.py)\n")
                    
                    
                    file_name = item.replace(" ", "_").replace("/", "_").replace("-", "_") + ".md"
                    file_path = os.path.join(current_path, file_name)
                    with open(file_path, 'w', encoding='utf-8') as file:
                        file.write(f"# {item}\n\n")
                        file.write(f'"""\n\nLecture: {parent_path}/{key}\nContent: {item}\n\n"""\n\n')

                    # 在README中添加文件链接
                    item_clean = item.replace(" ", "_").replace("/", "_").replace("-", "_")
                    parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
                    key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
                    readme_file.write(f"- [{item}](./{parent_clean}/{key_clean}/{item_clean}.md)\n")
        else:
            # # 创建文件并写入初始内容
            # file_name = key.replace(" ", "_").replace("/", "_").replace("-", "_") + ".py"
            # file_path = os.path.join(current_path, file_name)
            # with open(file_path, 'w', encoding='utf-8') as file:
            #     file.write(f"# {key}\n\n")
            #     file.write(f'"""\n\nLecture: {parent_path}/{key}\nContent: {key}\n\n"""\n\n')

            # # 在README中添加文件链接
            # parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
            # key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
            # readme_file.write(f"- [{key}](./{parent_clean}/{key_clean}/{file_name})\n")
            
            
            file_name = key.replace(" ", "_").replace("/", "_").replace("-", "_") + ".md"
            file_path = os.path.join(current_path, file_name)
            with open(file_path, 'w', encoding='utf-8') as file:
                file.write(f"# {key}\n\n")
                file.write(f'"""\n\nLecture: {parent_path}/{key}\nContent: {key}\n\n"""\n\n')

            # 在README中添加文件链接
            parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
            key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
            readme_file.write(f"- [{key}](./{parent_clean}/{key_clean}/{file_name})\n")

        # 添加空行以分隔不同的章节
        readme_file.write("\n")

def main():
    root_dir = './'
    # 创建根目录
    os.makedirs(root_dir, exist_ok=True)

    # 创建 README.md 文件
    with open(os.path.join(root_dir, "README.md"), 'w', encoding='utf-8') as readme_file:
        readme_file.write("# 投资组合管理\n\n")
        readme_file.write("这是一个关于投资组合管理的目录结构。\n\n")
        create_directories_and_files(root_dir, structure, readme_file)

    print("目录和文件结构已生成，并创建 README.md 文件。")

if __name__ == "__main__":
    main()